<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>WhisbiAPIGateway Client</title>

    <!-- Latest JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Custom styles for this template -->
    <!-- <link href="grid.css" rel="stylesheet"> -->

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">
        .entity-container{
            padding: 15px;
            font-size: 18px;
            min-height: 300px;
            background: #dbdfe5;
            margin-bottom: 10px;
        }
        .entity-container.bg-alt{
            background: #abb1b8;
        }
        .entity-container .entity-button{
            width:100%;
        }
        .entity-container .entity-padding{
            padding-top:10px;
        }
        .entity-container .entity-no-padding{
            padding-left:0;
            padding-right:0;
        }
    </style>

  </head>

  <body>

    <div class="container">

      <div class="page-header">
        <div class="pull-right">
          <div class="dropdown entity-button">
            response mode
            <button class="btn btn-default dropdown-toggle entity-button" type="button" id="response-mode-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              <span class="item">jsonp</span>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu entity-button" aria-labelledby="request-lead-dropdown">
              <li><a href="#">json</a></li>
              <li><a href="#">jsonp</a></li>
            </ul>
          </div>
        </div>
        <h1>WhisbiAPIGateway Client</h1>
      </div>


      <!-- Button controls -->
      <div class="row">

          <!-- LANDING CONTROLS -->
          <div class="col-xs-6">
            <div class="col-xs-12">
              <p class="h2">Landing</p>
            </div>

            <div class="col-xs-12 entity-container bg-alt">
                <p class="h4">Sessions</p>

                <!-- RequestLead -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button request-lead-button">Request Lead</button>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="dropdown entity-button">
                      <button class="btn btn-default dropdown-toggle entity-button" type="button" id="request-lead-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <span class="item">cmn</span>
                        <span class="caret"></span>
                      </button>
                      <ul class="dropdown-menu entity-button" aria-labelledby="request-lead-dropdown">
                        <li><a href="#">cmn</a></li>
                        <li><a href="#">alpha</a></li>
                        <li><a href="#">sched_user</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <!-- Random Locator -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button random-locator-button">Random Locator</button>
                  </div>
                  <div class="col-xs-6 text-center">
                      <input type="text" class=" input-group form-control random-locator-input" aria-describedby="basic-addon2">
                  </div>
                </div>
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button send-quiz-button">Send Quiz</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button get-availability-button">Get Availability</button>
                    </div>
                  </div>
                  <div class="col-xs-6 text-center">

                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button send-kpi-button">Send KPI</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button match-kpi-button">Match KPI</button>
                    </div>


                  </div>
                </div>


                <!-- Inbound Video Pin -->
                <div class="col-xs-12 entity-padding" style="padding-left:0px">
                  <p class="h4 entity-padding">Inbound Video & Alpha Pin</p>
                </div>
                <div class="col-xs-12 entity-padding">

                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button inbound-video-new-session-button">IV New Session</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button inbound-video-flag-button">IV Flag</button>
                    </div>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button new-alpha-button">New Alpha</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button alpha-status-button">Alpha Status</button>
                    </div>
                  </div>
                </div>

            </div>


              <!-- SESSION CONTROLS -->
              <div class="col-xs-12 entity-container bg-alt">
                <p class="h4">Room Seeds (Landing + Desktop)</p>

                <!-- Seed -->
                <div class="col-xs-12 entity-padding entity-no-padding">
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button create-seed-button">Create Seed</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button update-seed-button">Update Seed</button>
                    </div>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button read-seed-button">Read Seed</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button delete-seed-button">Delete Seed</button>
                    </div>
                  </div>
                </div>
                <!-- Room -->
                <div style="padding-left:0px" class="col-xs-12">
                  <p class="h4 entity-padding">Room</p>
                </div>
                <div class="col-xs-12 entity-no-padding">
                  <div class="col-xs-6 text-center">

                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button create-user-in-room-button">Create User</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <div class="dropdown entity-button">
                        <button class="btn btn-default dropdown-toggle entity-button" type="button" id="room-user-type-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                          <span class="item">user</span>
                          <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu entity-button" aria-labelledby="room-user-type-dropdown">
                          <li><a href="#">user</a></li>
                          <li><a href="#">agent</a></li>
                          <li><a href="#">viewer</a></li>
                          <li><a href="#">presenter</a></li>
                        </ul>
                      </div>
                    </div>

                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="dropdown entity-button">
                      <button type="button" class="btn btn-default entity-button update-user-info-button">Update User Info</button>
                    </div>
                  </div>
                </div>

                <div class="col-xs-12 entity-padding entity-no-padding">
                    <div class="col-xs-6 text-center">
                      <button type="button" class="btn btn-default entity-button read-room-button">Read Room</button>
                    </div>
                    <div class="col-xs-6 text-center">
                      <button type="button" class="btn btn-default entity-button update-room-button">Update Room</button>
                    </div>
                </div>

            </div>




          </div>

          <!-- DESKTOP CONTROLS -->
          <div class="col-xs-6">
            <div class="col-xs-12">
              <p class="h2">Desktop</p>
            </div>
            <!-- Users(Agent) -->
            <div class="col-xs-12 entity-container bg-alt">
                <p class="h4">User(Agent)</p>

                  <!-- 1st row -->
                  <div class="col-xs-12 entity-padding entity-no-padding">
                    <!-- Login/Logout -->
                    <div class="col-xs-6 text-center">
                      <div class="col-xs-6 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button login-button">Login</button>
                      </div>
                      <div class="col-xs-6 text-center entity-no-padding">
                        <input type="text" class=" input-group form-control login-input" aria-describedby="basic-addon2">
                      </div>
                    </div>
                    <div class="col-xs-6 text-center">
                      <div class="col-xs-12 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button logout-button">Logout</button>
                      </div>
                    </div>
                  </div>

                  <!-- 2nd row -->
                  <div class="col-xs-12 entity-padding entity-no-padding">

                  <!-- Change Status -->
                    <div class="col-xs-6 text-center">
                      <div class="col-xs-6 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button change-status-button">Change Status</button>
                      </div>
                      <div class="col-xs-6 text-center entity-no-padding">
                        <div class="dropdown entity-button">
                          <button class="btn btn-default dropdown-toggle entity-button" type="button" id="agent-status-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            <span class="item">available</span>
                            <span class="caret"></span>
                          </button>
                          <ul class="dropdown-menu entity-button" aria-labelledby="agent-status-dropdown">
                            <li><a href="#">available</a></li>
                            <li><a href="#">busy</a></li>
                            <li><a href="#">away</a></li>
                            <li><a href="#">in_session</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>

                    <!-- Alive -->
                    <div class="col-xs-6 text-center">

                      <div class="col-xs-6 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button alive-button">Alive</button>
                      </div>
                      <div class="col-xs-6 text-center entity-no-padding">
                        <div class="dropdown entity-button">
                          <button class="btn btn-default dropdown-toggle entity-button" type="button" id="alive-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            <span class="item">Empty</span>
                            <span class="caret"></span>
                          </button>
                          <ul class="dropdown-menu entity-button" aria-labelledby="alive-dropdown">
                            <li><a href="#">Empty</a></li>
                            <li><a href="#">Lead</a></li>
                            <li><a href="#">Branchgroup</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>


                  <!-- 3rd row -->
                  <div class="col-xs-12 entity-padding entity-no-padding">

                    <!-- Check VAteam -->
                    <div class="col-xs-6 text-center">
                      <div class="col-xs-6 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button check-vateam-button" data-action='check_vateam'>Check VATeam</button>
                      </div>
                      <div class="col-xs-6 text-center entity-no-padding">
                        <div class="dropdown entity-button">
                          <button class="btn btn-default dropdown-toggle entity-button" type="button" id="vateams-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            <span class="item"></span>
                            <span class="caret"></span>
                          </button>
                          <ul class="dropdown-menu entity-button vateams-dropdown-list" aria-labelledby="vateams-dropdown">
                          </ul>
                        </div>
                      </div>
                    </div>

                    <!-- Get VaTeams -->
                    <div class="col-xs-6 text-center">
                      <div class="col-xs-6 text-center entity-no-padding">
                        <button type="button" class="btn btn-default entity-button get-vateams-button">Get Vateams</button>
                      </div>
                      <div class="col-xs-6 text-center entity-no-padding">
                        <input type="text" class=" input-group form-control vacenter-input" aria-describedby="basic-addon2">
                      </div>
                    </div>

                 </div>

                 <!-- 4th row -->
                 <div class="col-xs-12 entity-padding">
                   <div class="col-xs-6 text-center" style="padding-left:0">
                     <button type="button" class="btn btn-default entity-button get-results-button">Get Results</button>
                   </div>
                   <div class="col-xs-6 text-center" style="padding-right:0">
                     <button type="button" class="btn btn-default entity-button get-queued-leads-button">Get Queued Leads</button>
                   </div>
                 </div>


                 <!-- 5th row -->
                 <div class="col-xs-12 entity-padding">
                   <div class="col-xs-6 text-center" style="padding-left:0">
                     <button type="button" class="btn btn-default entity-button get-inbound-ddi-button">Get Inbound DDIs</button>
                   </div>
                   <div class="col-xs-6 text-center" style="padding-right:0">
                   </div>
                 </div>


           </div>


            <!-- Session -->
            <div class="col-xs-12  entity-container bg-alt">
                <p class="h4">Session - Open Lead</p>
                <!-- Open Session/Create Lead -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button open-session-button">Open Session</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <input type="text" aria-describedby="basic-addon2" class=" input-group form-control locator-input">
                    </div>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button create-lead-button">Create Lead</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <div class="dropdown entity-button">
                        <button class="btn btn-default dropdown-toggle entity-button" type="button" id="create-lead-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                          <span class="item">Lead</span>
                          <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu entity-button" aria-labelledby="create-lead-dropdown">
                          <li><a href="#">Lead</a></li>
                          <li><a href="#">Whisbinar</a></li>
                        </ul>
                      </div>
                    </div>

                  </div>
                </div>


                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button free-session-resources-button">Free Session Resources</button>
                  </div>
                  <div class="col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button close-lead-button">Close Lead</button>
                  </div>
                </div>

                <div class="col-xs-12 entity-padding" style="padding-left:0px">
                  <p class="h4 entity-padding">Session - Finish Lead</p>
                </div>
                <!-- Set Result / Schedule Session -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button set-result-button">Set Result</button>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="dropdown entity-button">
                    <button type="button" class="btn btn-default entity-button schedule-session-button">Schedule Session</button>
                    </div>
                  </div>
                </div>

                <!-- Set Results / Search DB Lead -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="dropdown entity-button">
                    <button type="button" class="btn btn-default entity-button search-db-lead-button">Search DB Lead</button>
                    </div>
                  </div>
                </div>

                <!-- Load DB Lead -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-offset-6 col-xs-6 text-center">
                    <button type="button" class="btn btn-default entity-button load-db-lead-button">Load DB Lead</button>
                  </div>
                </div>

                <div class="col-xs-12 entity-padding" style="padding-left:0px">
                  <p class="h4 entity-padding">Session - Third Pary Call</p>
                </div>

                <!-- Third Pary controls -->
                <div class="col-xs-12 entity-padding">
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button call-third-button">Call Third</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                      <input type="text" aria-describedby="basic-addon2" class=" input-group form-control call-third-input">
                    </div>
                  </div>
                  <div class="col-xs-6 text-center">
                    <div class="col-xs-6 text-center entity-no-padding">
                      <button type="button" class="btn btn-default entity-button switch-speaker-button">Switch Speaker</button>
                    </div>
                    <div class="col-xs-6 text-center entity-no-padding">
                    <button type="button" class="btn btn-default entity-button redirect-third-button">Redirect Third</button>
                    </div>
                  </div>
                </div>

            </div>

          </div>
      </div>

      <!-- Console -->
      <div class="row">
        <div class="col-xs-12">
          <div class="form-group">
           <label for="comment">Console:</label>
           <textarea class="form-control console"  placeholder="WhisbiAPIGateway Client Output"  rows="20" id="comment" style="font-family:monospace;"></textarea>
          </div>
        </div>
      </div>

    </div> <!-- /container -->


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->

    <!-- RSA encryption -->
    <script src="http://kjur.github.io/jsrsasign/jsrsasign-latest-all-min.js"></script>

    <!-- Logger -->
    <script src="./js/logger.min.js"></script>

    <!-- WhisbiAPIClient -->
    <script src="./js/client.js"></script>
    <script src="./js/client_jsonp.js"></script>


    <script type="text/javascript">

      var phone_head = "+34695698"
      var alive_timer;
      var alive_lead_timer;
      var alive_whisbinar_timer;
      var alive_room;
      var alive_pin;
      var alive_alpha;
      var room_seed;
      var api_client;
      var api_client_jsonp;

      /**
       * Appends message to console
       */
      function append_to_console(messages, context){
        var date = new Date()
        var current_time = date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds();
        $('.console').append(context.level.name + " | " + current_time + " | "+ messages[0] +  '\n')
        //console.log(context.level.name + " | " + current_time + " | "+ messages[0])
      }

      /**
       * Selects an item in the dropdown-menu
       */
      function selected_item(){
        var selected_text = $(this).text();
        var item = $(this).parent().parent().parent().children(":first-child").children(".item")
        item.html(selected_text)
        item.val(selected_text)
      }

      /**
       * Generate random locator
       */
      function generate_random_locator(){
        function zero_padding (str, max) {
          return str.length < max ? pad("0" + str, max) : str;
        }

        var max = 1000;
        var tail = Math.floor(Math.random()*max);
        $(".random-locator-input").val(phone_head + zero_padding(tail, max))
        $(".locator-input").val(phone_head + zero_padding(tail, max))
      }

      /**
       * Generates a Random Seed
       */
      function generate_random_guid(){
        var max = 10;
        var guid_1 = Math.floor(Math.random()*max);
        var guid_2 = Math.floor(Math.random()*max);
        var guid_3 = Math.floor(Math.random()*max);
        return  "01860ced-229e-4047-812f-8f70c29c4" + guid_1 + guid_2 + guid_3;
      }

      /**
       * Returns whether response should be JSON or JSONP
       */
      function get_api_mode(){
        var response_mode = $("#response-mode-dropdown span").text()
        if( response_mode == "json" ){
          return api_client
        }else if( response_mode == "jsonp" ){
          return api_client_jsonp
        }
      }

      /**
       * Callback functions
       */
      function login_callback(result){
        // Clear items
        var list = $(".vateams-dropdown-list")
        list.html('')

        $.each(result.vateams, function(index, item){
          if(index == 0 )
            $("#vateams-dropdown .item").text(item.name)

          // Generate new item to append to list
          var li = $('<li/>').appendTo(list);
          var a = $('<a/>') .text( item.name ) .attr('href', "#").appendTo(li);
          a.click(selected_item)
          // Set time to perform_alive
          alive_timer = setInterval(function(){
            var api_mode = get_api_mode()
            api_mode.request_alive()
          },
          5000);

        })
      }
      function logout_callback(result){
        clearInterval(alive_timer);

      }
      function open_session_callback(result){
        alive_lead_timer = setInterval(function(){
          var api_mode = get_api_mode()
          api_mode.request_alive_lead();
        }, 5000);
      }
      function load_db_lead_callback(result){
        alive_lead_timer = setInterval(function(){
          var api_mode = get_api_mode()
          api_mode.request_alive_lead();
        }, 5000);
      }
      function go_alpha_callback(result){
        alive_lead_timer = setInterval(function(){api_client.request_alive_lead();}, 5000);
      }
      function set_result_callback(result){
        clearInterval(alive_lead_timer);
        clearInterval(alive_room);
        clearInterval(alive_pin);
        clearInterval(alive_alpha);
        api_client.user_gari_id = "";
        api_client.agent_gari_id = "";
        api_client.viewer_gari_id = "";
        api_client.presenter_gari_id = "";
      }
      function create_whisbinar_callback(result){
        alive_whisbinar_timer = setInterval(function(){
          var api_mode = get_api_mode()
          api_mode.request_alive_branchgroup();
        }, 5000);
      }
      function close_whisbinar_callback(result){
        clearInterval(alive_whisbinar_timer);
      }
      function create_user_in_room_callback(result){
        alive_room = setInterval(send_alive_room, 5000);
      }
      function request_iv_new_session_callback(result){
        alive_pin = setInterval(function(){
          var api_mode = get_api_mode()
          api_mode.request_iv_flag()
        }, 5000);
      }
      function new_alpha_callback(result){
        alive_alpha = setInterval(function(){
          var api_mode = get_api_mode()
          api_mode.request_alpha_status()
        }, 5000);
      }


      /**
       * Sends an alive to GARI to keep room user alive
       */
      function send_alive_room(){
        Logger.info("Perform 'sending alive to room' ...");
        if( api_client.user_gari_id != "" )
          api_client.request_read_room(api_client.user_gari_id)
        if( api_client.agent_gari_id != "" )
          api_client.request_read_room(api_client.agent_gari_id)
        if( api_client.viewer_gari_id != "" )
          api_client.request_read_room(api_client.viewer_gari_id)
        if( api_client.presenter_gari_id != "" )
          api_client.request_read_room(api_client.presenter_gari_id)
      }

      $(function(){

        api_client = new WhisbiAPIClient()
        api_client_jsonp = new WhisbiAPIClientJSONP()

        // Set random locator
        //generate_random_locator()
        $(".random-locator-input").val("+34910800161")
        $(".locator-input").val("+34910800161")
        $(".login-input").val(api_client.user_id)
        $(".vacenter-input").val(api_client.vacenter_id)
        $(".call-third-input").val('+34607288333')


        // Log messages will be written to the window's console.
        Logger.useDefaults();
        Logger.setHandler(function (messages, context) {
          append_to_console(messages, context)
        });

         // Sets the selected action in dropdown-menu
         $(".dropdown-menu li a").click(selected_item);

         // Handler to generate random locator
         $(".random-locator-button").click(generate_random_locator);

         $( "#request-lead-dropdown" ).next().click(function() {
           if( $("#request-lead-dropdown span").text() == "cmn"){
             var locator = $(".random-locator-input").val()
             $(".locator-input").val(locator)
           }else if( $("#request-lead-dropdown span").text() == "alpha"){
             var alpha_pin;
             var api_mode = get_api_mode()
             $(".locator-input").val(api_mode.alpha_pin)
           }
         });


         // ------------------------------------
         // Button handlers - Connect to Gateway
         // ------------------------------------

         // Desktop - Agent
         $(".login-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_login(login_callback)
         });
         $(".logout-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_logout(logout_callback)
         });
         $(".change-status-button").click(function(){
           var status = $("#agent-status-dropdown span").text()
           var api_mode = get_api_mode()
           api_mode.request_change_status(status)
         });

         $(".check-vateam-button").click(function(){
           var item = $(".check-vateam-button")
           var vateam_name = $("#vateams-dropdown span").text()
           var api_mode = get_api_mode()
           api_mode.request_check_vateam(item.data('action'), vateam_name)

           // Change next action - Assume action was ok
           if( item.data('action') == "check_vateam"){
             item.data('action', 'uncheck_vateam')
             item.text("Uncheck Vateam")
           }else{
             item.data('action', 'check_vateam')
             item.text("Check Vateam")
           }
         });
         $(".alive-button").click(function(){

           // Select type of api_client
           var api_mode = get_api_mode()

           // Define alive endpoint to contact
           var alive_type = $("#alive-dropdown span").text()
           switch(alive_type){
              case 'Empty':
                api_mode.request_alive()
                break;
              case 'Lead':
                api_mode.request_alive_lead()
                break;
              case 'Branchgroup':
                api_mode.request_alive_branchgroup()
                break;
           }

         });
         $(".get-vateams-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_get_vateams()
         })

         $(".get-results-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_get_results()
         })
         $(".get-queued-leads-button").click(function(){
           var vateam_name = $("#vateams-dropdown span").text()
           var api_mode = get_api_mode()
           api_mode.request_get_queued_leads(vateam_name)
         })
         $(".get-inbound-ddi-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_get_inbound_ddis()
         })

         // Desktop - Session
         $(".open-session-button").click(function(){
           var locator = $(".locator-input").val()
           var type = $("#request-lead-dropdown span").text()
           if( type == "cmn" ){
             var api_mode = get_api_mode()
             api_mode.request_open_session(locator, "12345", open_session_callback)
           }else if(type == "alpha"){
             var locator = $(".locator-input").val()
             var api_mode = get_api_mode()
             api_mode.request_go_alpha(locator, go_alpha_callback)
           }

         })
         $(".free-session-resources-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_free_session_resources()
         })
         $(".create-lead-button").click(function(){
           var type = $("#create-lead-dropdown span").text()
           if( type == 'Lead'){
             var vateam_name = $("#vateams-dropdown span").text()
             var locator = $(".random-locator-input").val()
             var api_mode = get_api_mode()
             api_mode.request_create_lead(locator, vateam_name, room_seed)
           }else{
             var seed = "668be3bb-f607-4487-b802-ffdcd6033dc9"
             var api_mode = get_api_mode()
             api_mode.request_create_lead_whisbinar(seed, api_client.branchgroup_whisbinar,
                                                        create_whisbinar_callback)
           }
         })
         $(".close-lead-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_close_lead_whisbinar(close_whisbinar_callback)
         })
         $(".set-result-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_set_result(set_result_callback)
         })


         $(".schedule-session-button").click(function(){
            // Generate Schedule Date
            var now = new Date();
            var dd = now.getDate();
            var mm = now.getMonth()+1; //January is 0!
            var hh = now.getHours()+1
            var MM = now.getMinutes()

            var yyyy = now.getFullYear();
            if(dd<10) dd ='0'+dd;
            if(mm<10) mm ='0'+mm;
            if(hh<10) hh ='0'+hh;
            var current_date = yyyy + "-" + mm + "-" + dd + " ";
            current_date += hh +':'+MM+':00';

            // Perform call
            var sched_datetime = current_date
            var sched_phone    = "+34695635851"
            var api_mode = get_api_mode()
            api_mode.request_schedule_session(sched_datetime, sched_phone)
         })
         $(".search-db-lead-button").click(function(){
           var locator = $(".random-locator-input").val()
           var api_mode = get_api_mode()
           api_mode.request_search_db_lead(locator)
         })
         $(".load-db-lead-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_load_db_lead(load_db_lead_callback)
         })


         // Landing - Sessions
         $(".request-lead-button").click(function(){
           var type = $("#request-lead-dropdown span").text()
           if( type == "cmn"){
             var locator = $(".random-locator-input").val()
             var api_mode = get_api_mode()
             api_mode.request_lead(type, locator, room_seed)
           }
         })
         $(".send-quiz-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_send_quiz();
         })
         $(".get-availability-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_get_availability()
         })
         $(".send-kpi-button").click(function(){
           var cookieguid = generate_random_guid();
           var kpiguid = generate_random_guid();
           var api_mode = get_api_mode()
           api_mode.request_send_kpi(cookieguid, kpiguid)
         })
         $(".match-kpi-button").click(function(){
           var kpiguid = generate_random_guid();
           var api_mode = get_api_mode()
           api_mode.request_match_kpi_session(kpiguid)
         })

         $(".inbound-video-new-session-button").click(function(){
           var response_mode = get_api_mode()
           var api_mode = get_api_mode()
           api_mode.request_iv_new_session(request_iv_new_session_callback)
         })
         $(".inbound-video-flag-button").click(function(){
           var response_mode = get_api_mode()
           var api_mode = get_api_mode()
           api_mode.request_iv_flag()
         })

         $(".new-alpha-button").click(function(){
           var cookieguid = generate_random_guid();
           var kpiguid = generate_random_guid();
           var api_mode = get_api_mode()
           api_mode.request_new_alpha(cookieguid, kpiguid, new_alpha_callback)
         })
         $(".alpha-status-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_alpha_status()
         })

         // Seeds - Sessions
         $(".create-seed-button").click(function(){
           room_seed =  generate_random_guid();
           var api_mode = get_api_mode()
           api_mode.request_create_seed(room_seed)
         })
         $(".update-seed-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_update_seed(room_seed)
         })
         $(".read-seed-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_read_seed(room_seed)
         })
         $(".delete-seed-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_delete_seed(room_seed)
         })

         // Rooms - Sessions
         $(".create-user-in-room-button").click(function(){
           var type = $("#room-user-type-dropdown span").text()
           var api_mode = get_api_mode()
           api_mode.request_create_user_in_room(type, create_user_in_room_callback)
         })

         $(".read-room-button").click(function(){
           Logger.info("Perform 'read' room ...");
           var type = $("#room-user-type-dropdown span").text()
           // Select type of api_client
           var api_mode = get_api_mode()

           var user_id;
           switch(type){
             case "user": user_id = api_mode.user_gari_id;
             break;
             case "agent":user_id = api_mode.agent_gari_id;
             break;
             case "viewer":user_id = api_mode.viewer_gari_id;
             break;
             case "presenter":user_id = api_mode.presenter_gari_id;
             break;
           }
           api_mode.request_read_room(user_id)
         })


         $(".update-room-button").click(function(){
           var type = $("#room-user-type-dropdown span").text()

           var api_mode = get_api_mode()

           var user_id;
           switch(type){
             case "user": user_id = api_mode.user_gari_id;
             break;
             case "agent":user_id = api_mode.agent_gari_id;
             break;
             case "viewer":user_id = api_mode.viewer_gari_id;
             break;
             case "presenter":user_id = api_mode.presenter_gari_id;
             break;
           }
           api_mode.request_update_room(user_id)
         })


         $(".update-user-info-button").click(function(){
           var type = $("#room-user-type-dropdown span").text()

           var api_mode = get_api_mode()

           var user_id;
           switch(type){
             case "user": user_id = api_mode.user_gari_id;
             break;
             case "agent":user_id = api_mode.agent_gari_id;
             break;
             case "viewer":user_id = api_mode.viewer_gari_id;
             break;
             case "presenter":user_id = api_mode.presenter_gari_id;
             break;
           }
           api_mode.request_update_user_info(user_id)
         })

         // Third Party Controls
         $(".call-third-button").click(function(){
           var third_phone = $(".call-third-input").val()
           var api_mode = get_api_mode()
           api_mode.request_call_third(third_phone)
         });
         var current_type = "user"
         $(".switch-speaker-button").click(function(){
           if( current_type == "user" ) current_type = "third";
           else current_type = "user"
           var api_mode = get_api_mode()
           api_mode.request_switch_speaker(current_type)
         });
         $(".redirect-third-button").click(function(){
           var api_mode = get_api_mode()
           api_mode.request_redirect_third()
         });


      });
    </script>

  </body>
</html>
